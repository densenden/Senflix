{# Movie Detail Page: Inhalte & Bewertungsoptionen #}
{% extends 'base.html' %}
{% from 'components/navigation.html' import top_nav, side_nav %}
{% block content %}
{{ top_nav(current_user=current_user) }}
<div class="flex flex-row bg-black min-h-screen pt-16">
  {{ side_nav() }}
  <div id="main-content" class="flex-1 transition-all duration-500">
    <div class="container mx-auto p-4 text-white">
      <div class="flex flex-col md:flex-row gap-8">
        <img src="{{ movie.poster_img or movie.poster_url or url_for('static', filename='movies/no-poster.jpg') }}" alt="{{ movie.title }}" class="w-64 h-96 rounded-lg shadow-lg object-cover">
        <div class="flex-1">
          <h2 class="text-3xl font-bold mb-2">{{ movie.title }}</h2>
          <div class="flex flex-wrap gap-2 mb-4">
            {% for category in movie.categories %}
              {% set category_obj = category %}
              {% include 'components/category_badge.html' %}
            {% endfor %}
          </div>
          <p class="mb-2"><span class="font-semibold">Year:</span> {{ movie.year }}</p>
          <p class="mb-2"><span class="font-semibold">Rating:</span> {{ movie.imdb_rating or 'N/A' }}</p>
          <p class="mb-2"><span class="font-semibold">Plot:</span> {{ movie.plot or 'No plot available.' }}</p>
          <div class="mt-4">
            {% include 'components/rating_component.html' %}
          </div>
        </div>
      </div>
      <div class="mt-8">
        <h3 class="text-2xl font-semibold mb-2">Community Ratings & Comments</h3>
        {% if ratings %}
          <div class="space-y-2">
            {% for r in ratings %}
              <div class="bg-gray-800 rounded p-3">
                <span class="font-bold">{{ r.rating }}/10</span> â€” {{ r.comment or 'No comment.' }}
              </div>
            {% endfor %}
          </div>
        {% else %}
          <p>No community ratings yet.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
